<!DOCTYPE html>
<html lang="pt">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>√Årea do Cliente</title>
  <link rel="stylesheet" href="usuario.css">

  <!-- Calendly link widget -->
  <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
  <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>
</head>

<body>

  <header class="usuario-header">
    <div class="usuario-profile">
      <img src="images/user-placeholder.jpg" alt="Foto de perfil" id="header-foto">
    </div>
    <h1 id="welcome-message">Bem-vindo, Cliente!</h1>
    <div class="usuario-status">
      <span class="status-badge">Cliente Ativo</span>
    </div>
    <a href="inicio.html" class="logout-link">Sair</a>
    
    <div class="usuario-nav">
      <a href="#" class="nav-item active" data-section="dashboard">Dashboard</a>
      <a href="#" class="nav-item" data-section="perfil">Perfil</a>
      <a href="#" class="nav-item" data-section="historico">Hist√≥rico</a>
      <a href="#" class="nav-item" data-section="ajuda">Ajuda</a>
    </div>
  </header>

  <main>
    <!-- Dashboard Section -->
    <div id="dashboard-section" class="content-section active">
      <section class="boas-vindas">
        <h2>√Årea do Cliente</h2>
        <p>Aqui voc√™ pode visualizar dicas personalizadas e os hor√°rios dispon√≠veis para agendamento.</p>
      </section>

      <section class="agendamento">
        <h2>Agende sua pr√≥xima consulta</h2>
        <p>Escolha o melhor hor√°rio para sua consulta atrav√©s do nosso calend√°rio online.</p>
        <button id="agendar">Agendar Consulta</button>
      </section>

      <section class="dicas">
        <h2>Dicas Personalizadas</h2>
        <div class="dicas-container" id="lista-dicas-clientes">
          <!-- As dicas ser√£o carregadas aqui -->
          <p id="loading-dicas">Carregando dicas...</p>
        </div>
      </section>
      
      <section class="historico">
        <h2>√öltimas Consultas</h2>
        <div class="historico-container" id="historico-resumo">
          <!-- Hist√≥rico resumido ser√° carregado aqui -->
        </div>
      </section>
    </div>

    <!-- Perfil Section -->
    <div id="perfil-section" class="content-section">
      <section class="perfil">
        <h2>Meu Perfil</h2>
        <div class="perfil-container">
          <div class="perfil-foto">
            <div class="foto-preview" id="foto-preview">
              <span class="foto-placeholder">üë§</span>
            </div>
            <button class="btn-foto" onclick="alterarFoto()">Alterar Foto</button>
            <input type="file" id="input-foto" accept="image/*" style="display: none;">
          </div>
          <div class="perfil-form">
            <div class="form-group">
              <label for="nome">Nome Completo</label>
              <input type="text" id="nome" name="nome" readonly>
            </div>
            <div class="form-group">
              <label for="email">Email</label>
              <input type="email" id="email" name="email" readonly>
            </div>
            <div class="form-group">
              <label for="telefone">Telefone</label>
              <input type="tel" id="telefone" name="telefone" readonly>
            </div>
            <div class="form-group">
              <label for="endereco">Endere√ßo</label>
              <input type="text" id="endereco" name="endereco" readonly>
            </div>
            <div class="form-group">
              <label for="data_nascimento">Data de Nascimento</label>
              <input type="date" id="data_nascimento" name="data_nascimento" readonly>
            </div>
            <div class="form-actions">
              <button class="btn-primary" id="btn-editar" onclick="toggleEdicao()">Editar Perfil</button>
              <button class="btn-secondary" id="btn-cancelar" onclick="cancelarEdicao()" style="display: none;">Cancelar</button>
            </div>
          </div>
        </div>
      </section>
    </div>

    <!-- Hist√≥rico Section -->
    <div id="historico-section" class="content-section">
      <section class="historico-detalhado">
        <h2>Hist√≥rico Completo de Consultas</h2>
        <div class="historico-container" id="historico-completo">
          <div class="loading">Carregando hist√≥rico...</div>
        </div>
      </section>
    </div>

    <!-- Ajuda Section -->
    <div id="ajuda-section" class="content-section">
      <section class="ajuda">
        <h2>Central de Ajuda</h2>
        <div class="ajuda-container">
          <div class="ajuda-item">
            <h3>Como agendar uma consulta?</h3>
            <p>Para agendar uma consulta, clique no bot√£o "Agendar Consulta" na dashboard ou entre em contato atrav√©s dos nossos canais de atendimento.</p>
          </div>
          <div class="ajuda-item">
            <h3>Como alterar meus dados?</h3>
            <p>V√° at√© a se√ß√£o "Perfil" e clique em "Editar Perfil" para alterar suas informa√ß√µes.</p>
          </div>
          <div class="ajuda-item">
            <h3>Como visualizar meu hist√≥rico?</h3>
            <p>Na se√ß√£o "Hist√≥rico" voc√™ pode ver todas as suas consultas anteriores com detalhes.</p>
          </div>
          <div class="ajuda-item">
            <h3>Problemas com o sistema?</h3>
            <p>Se voc√™ encontrar algum problema, entre em contato conosco atrav√©s do email: contato@cleonunes.com.br</p>
          </div>
        </div>
      </section>
    </div>
  </main>

  <!-- Modal para detalhes da consulta -->
  <div id="modal-consulta" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Detalhes da Consulta</h3>
        <span class="close" onclick="fecharModal()">&times;</span>
      </div>
      <div class="modal-body" id="modal-body-consulta">
        <!-- Conte√∫do ser√° preenchido dinamicamente -->
      </div>
    </div>
  </div>

  <footer>
    <div class="footer-content">
      <div class="footer-nav">
        <a href="#">In√≠cio</a>
        <a href="#">Sobre</a>
        <a href="#">Contato</a>
        <a href="#">Privacidade</a>
      </div>
      <div class="social-links">
        <a href="#"><span>FB</span></a>
        <a href="#"><span>IG</span></a>
        <a href="#"><span>WA</span></a>
      </div>
      <p>Cl√©o Nunes Terapeuta</p>
      <p>contato@cleonunes.com.br</p>
      <p class="copyright">&copy; 2025 Cl√©o Nunes Terapeuta. Todos os direitos reservados.</p>
    </div>
  </footer>

  <script>
    // Calendly integration
    document.getElementById("agendar").addEventListener("click", function () {
      Calendly.initPopupWidget({ url: 'https://calendly.com/julianunesteixeira4' });
      return false;
    });

    // Carregar dicas do cliente
    async function carregarDicasCliente() {
      const container = document.getElementById('lista-dicas-clientes');
      const loading = document.getElementById('loading-dicas');

      try {
        const response = await fetch('http://localhost:3000/api/dicas');

        if (!response.ok) {
          throw new Error(`Erro na requisi√ß√£o: ${response.status}`);
        }

        const dicas = await response.json();

        loading.style.display = 'none';

        if (dicas.length === 0) {
          container.innerHTML = '<p>Nenhuma dica dispon√≠vel no momento.</p>';
          return;
        }

        container.innerHTML = '';

        dicas.forEach(dica => {
          const div = document.createElement('div');
          div.className = 'dicas-item';
          div.innerHTML = `
            <span class="dica-icon">üí°</span>
            <h3>${dica.titulo}</h3>
            <p>${dica.descricao}</p>
          `;
          container.appendChild(div);
        });

        console.log("Dicas carregadas com sucesso:", dicas);
      } catch (error) {
        console.error('Erro ao carregar dicas:', error);
        loading.style.display = 'none';
        container.innerHTML = `<p class="erro">N√£o foi poss√≠vel carregar as dicas. Tente novamente mais tarde.</p>`;
      }
    }

    // Carregar dicas quando a p√°gina for carregada
    document.addEventListener('DOMContentLoaded', function() {
      carregarDicasCliente();
    });
  </script>
  <script src="js/usuario.js"></script>
</body>

</html>